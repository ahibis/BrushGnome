var Ee=Object.defineProperty;var ze=(m,l,t)=>l in m?Ee(m,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[l]=t;var E=(m,l,t)=>(ze(m,typeof l!="symbol"?l+"":l,t),t);import{d as Ne,t as se,r as H,u as o,o as h,c as L,a as n,V as Ie,b as oe,w as a,e as v,f as j,g as P,h as C,i as I,C as Ae,p as Te,j as Re,k as Me,L as he,l as Be,P as ge,m as Fe,B as Oe,n as ae,q as U,s as Xe,v as $,x as le,y as te,z as je,A as J,D as ue,F,E as de,G as R,H as M,I as K,J as ke,K as ce,M as me,N as pe,O as re,Q as ie,R as Ge,S as Ke,T as _e,U as xe,W as ve,X as He,Y as ee,Z as ye,_ as we,$ as qe,a0 as We,a1 as Ye,a2 as Je,a3 as Qe,a4 as Ze}from"./vendor.c706f790.js";const et=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const e of i)if(e.type==="childList")for(const r of e.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const e={};return i.integrity&&(e.integrity=i.integrity),i.referrerpolicy&&(e.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?e.credentials="include":i.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function s(i){if(i.ep)return;i.ep=!0;const e=t(i);fetch(i.href,e)}};et();class Kt extends PIXI.Container{constructor(){super(...arguments);E(this,"Name","layer");E(this,"type","layer")}get r(){return(this.tint&16711680)/65536,(this.tint&16711680)/65536}set r(l){let t=l%256*65536+(65535&this.tint);this.tint=t}get g(){return(this.tint&65280)/256}set g(l){this.tint=l%256*256+(16711935&this.tint)}get b(){return this.tint&255}set b(l){this.tint=l%256+(16776960&this.tint)}}let Y;class fe extends PIXI.Sprite{constructor(...l){super(...l);E(this,"Name","picture");E(this,"type","sprite");this.eventsBind()}eventsBind(){this.interactive=!0,this.buttonMode=!0;let l,t=0,s,i,e,r;const u=10;setTimeout(()=>{this.width>800&&(this.width=800),this.scale.y=this.scale.x},50),this.on("pointerdown",d=>{l=d.data.getLocalPosition(this),l.x*=this.scale.x,l.y*=this.scale.y,e=d.data.getLocalPosition(this.parent);const{width:c,height:g}=this;if(this.zIndexOld=this.zIndex,r=this,this.zIndex||(this.zIndex=0),this.zIndex=100,console.log(this.zIndex),s=c,i=g,l.x>c-u)return t=1;if(l.x<u)return t=2;if(l.y>g-u)return t=3;if(l.y<u)return t=4;t=0}),Y.stage.on("pointerup",d=>{r&&(r.zIndex=r.zIndexOld),l=!1}),this.on("pointermove",d=>{const{ctrlKey:c}=d.data.originalEvent;if(l){const g=d.data.getLocalPosition(this.parent);t==0&&(this.x=g.x-l.x,this.y=g.y-l.y),t==1&&(this.width=s+g.x-e.x,c&&(this.scale.y=this.scale.x)),t==2&&(this.x=g.x-l.x,this.width=s-g.x+e.x),t==3&&(this.height=i+g.y-e.y,c&&(this.scale.x=this.scale.y)),t==4&&(this.y=g.y-l.y,this.height=i-g.y+e.y)}})}get r(){return(this.tint&16711680)/65536,(this.tint&16711680)/65536}set r(l){let t=l%256*65536+(65535&this.tint);this.tint=t}get g(){return(this.tint&65280)/256}set g(l){this.tint=l%256*256+(16711935&this.tint)}get b(){return this.tint&255}set b(l){this.tint=l%256+(16776960&this.tint)}pixels(){const l=this.texture.textureCacheIds[0],t=new fe;t.src=l,t.onload=function(){}}}class tt{constructor(l,t){E(this,"sprites",[]);E(this,"textures",[]);E(this,"width",1080);E(this,"height",768);E(this,"ctx");E(this,"view");E(this,"app");E(this,"room");E(this,"extract");E(this,"_sprites",0);this.sprites=t,Y=new PIXI.Application({width:this.width,height:this.height,transparent:!0,resolution:window.devicePixelRatio||1}),this.extract=Y.renderer.extract,this.app=Y,this.view=Y.view;const{stage:s}=Y;s.interactive=!0,s.buttonMode=!0,this.stage=s;const i=s;i.sortableChildren=!0,i.Name="Main layer",i.id=0,this.room=i,t.push({Name:"Main layer",type:"layer",id:0}),this.ctx=this.view.getContext("webgl2"),l.appendChild(Y.view)}async loadPixels(l){let{width:t,height:s}=l;const i=document.createElement("canvas");i.width=t,i.height=s;const e=i.getContext("2d");return e.drawImage(l,0,0,t,s),await e.getImageData(0,0,t,s).data}loadImg(l){return new Promise((t,s)=>{let i=new Image;i.src=l,i.onload=e=>{t(i)}})}pixels(){return this.extract.pixels(this.app.stage)}pixelsToHistogram(l){const t=_.map(_.range(256),e=>0);let s=[t.slice(),t.slice(),t.slice(),t.slice()],i;for(let e=0;e<l.length;e+=1)e%4!=3&&~~(e/4)*4+3!=0&&(i=l[e],s[e%4][i]+=1,s[3][i]+=1);return s}histogram(){const l=this.pixels();return this.pixelsToHistogram(l)}saveFile(l,t="outImg"){let s=document.createElement("a");s.setAttribute("href",l),s.setAttribute("download",t),s.click()}downImg(){const l=this.extract.image(this.app.stage);this.saveFile(l.src)}addSprite(l){const{textures:t,sprites:s,room:i}=this,e=PIXI.Texture.from(l);t.push(e),this._sprites+=1;const r=new fe(e);return r.id=this._sprites,s.push(r),i.addChild(r),r}}const X=Ne("game",{state:()=>({sprites:[],selectedSprite:void 0,drawer:!1,isEditor:!0,isList:!0})}),lt={key:0},nt=C(" width "),at=C(" height "),it=C(" red "),st=C(" green "),ot=C(" blue "),rt=C(" alpha "),ut=C(" x "),dt=C(" y "),ct=C(" z "),mt={key:1},pt=I("h3",null,"\u0421\u043F\u0440\u0430\u0439\u0442 \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D \u0438\u043B\u0438 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043D\u0435 \u0441\u043F\u0440\u0430\u0439\u0442\u043E\u043C",-1),ft=[pt],Ce={setup(m){const l=X(),t=se(l,"selectedSprite"),s=H([{title:"normal",value:PIXI.BLEND_MODES.NORMAL},{title:"add",value:PIXI.BLEND_MODES.ADD},{title:"multiply",value:PIXI.BLEND_MODES.MULTIPLY},{title:"average",value:PIXI.BLEND_MODES.SCREEN}]);return(i,e)=>{var r;return((r=o(t))==null?void 0:r.type)=="sprite"?(h(),L("div",lt,[n(Ie,{label:"name",modelValue:o(t).Name,"onUpdate:modelValue":e[0]||(e[0]=u=>o(t).Name=u),"hide-details":""},null,8,["modelValue"]),n(oe,{label:"blend mode",items:o(s),modelValue:o(t).blendMode,"onUpdate:modelValue":e[1]||(e[1]=u=>o(t).blendMode=u),"hide-details":""},null,8,["items","modelValue"]),n(P,null,{default:a(()=>[n(v,{sm:"3"},{default:a(()=>[nt]),_:1}),n(v,null,{default:a(()=>[n(j,{min:"0",max:"1080",step:"5","thumb-label":"","hide-details":"auto",color:"blue",modelValue:o(t).width,"onUpdate:modelValue":e[2]||(e[2]=u=>o(t).width=u)},null,8,["modelValue"])]),_:1})]),_:1}),n(P,null,{default:a(()=>[n(v,{sm:"3"},{default:a(()=>[at]),_:1}),n(v,null,{default:a(()=>[n(j,{min:"0",max:"1080",step:"5","thumb-label":"",color:"blue","hide-details":"auto",modelValue:o(t).height,"onUpdate:modelValue":e[3]||(e[3]=u=>o(t).height=u)},null,8,["modelValue"])]),_:1})]),_:1}),n(P,null,{default:a(()=>[n(v,{sm:"3"},{default:a(()=>[it]),_:1}),n(v,null,{default:a(()=>[n(j,{min:"0",max:"255",step:"5","thumb-label":"",color:"red","hide-details":"auto",modelValue:o(t).r,"onUpdate:modelValue":e[4]||(e[4]=u=>o(t).r=u)},null,8,["modelValue"])]),_:1})]),_:1}),n(P,null,{default:a(()=>[n(v,{sm:"3"},{default:a(()=>[st]),_:1}),n(v,null,{default:a(()=>[n(j,{min:"0",max:"255",step:"5","thumb-label":"",color:"green","hide-details":"auto",modelValue:o(t).g,"onUpdate:modelValue":e[5]||(e[5]=u=>o(t).g=u)},null,8,["modelValue"])]),_:1})]),_:1}),n(P,null,{default:a(()=>[n(v,{sm:"3"},{default:a(()=>[ot]),_:1}),n(v,null,{default:a(()=>[n(j,{min:"0",max:"255",step:"5","thumb-label":"",color:"blue","hide-details":"auto",modelValue:o(t).b,"onUpdate:modelValue":e[6]||(e[6]=u=>o(t).b=u)},null,8,["modelValue"])]),_:1})]),_:1}),n(P,null,{default:a(()=>[n(v,{xs:"1",sm:"3"},{default:a(()=>[rt]),_:1}),n(v,null,{default:a(()=>[n(j,{"hide-details":"auto",max:"1",min:"0",step:"0.05",color:"blue","thumb-label":"",modelValue:o(t).alpha,"onUpdate:modelValue":e[7]||(e[7]=u=>o(t).alpha=u)},null,8,["modelValue"])]),_:1})]),_:1}),n(P,null,{default:a(()=>[n(v,{sm:"3"},{default:a(()=>[ut]),_:1}),n(v,null,{default:a(()=>[n(j,{min:"0",max:"1080",step:"5","thumb-label":"",color:"blue","hide-details":"auto",modelValue:o(t).x,"onUpdate:modelValue":e[8]||(e[8]=u=>o(t).x=u)},null,8,["modelValue"])]),_:1})]),_:1}),n(P,null,{default:a(()=>[n(v,{sm:"3"},{default:a(()=>[dt]),_:1}),n(v,null,{default:a(()=>[n(j,{min:"0",max:"1080",step:"5","thumb-label":"",color:"blue","hide-details":"auto",modelValue:o(t).y,"onUpdate:modelValue":e[9]||(e[9]=u=>o(t).y=u)},null,8,["modelValue"])]),_:1})]),_:1}),n(P,null,{default:a(()=>[n(v,{sm:"3"},{default:a(()=>[ct]),_:1}),n(v,null,{default:a(()=>[n(j,{min:"-10",max:"10",step:"1","thumb-label":"",color:"blue","hide-details":"auto",modelValue:o(t).zIndex,"onUpdate:modelValue":e[10]||(e[10]=u=>o(t).zIndex=u)},null,8,["modelValue"])]),_:1})]),_:1})])):(h(),L("div",mt,ft))}}},Se={props:{chartId:{type:String,default:"bar-chart"},datasetIdKey:{type:String,default:"label"},width:{type:Number,default:400},height:{type:Number,default:400},cssClasses:{default:"",type:String},styles:{type:Object,default:()=>{}},plugins:{type:Array,default:()=>[]},data:{type:Array,default:()=>[_.map(_.range(256),m=>0),_.map(_.range(256),m=>0),_.map(_.range(256),m=>0),_.map(_.range(256),m=>0)]}},setup(m){const l=m;Ae.register(Te,Re,Me,he,Be,ge,Fe,Oe,he,ge);const t=ae(i=>({labels:_.range(256),datasets:[{data:l.data[0],backgroundColor:"#F44336",label:"red"},{data:l.data[1],backgroundColor:"#4CAF50",label:"green"},{data:l.data[2],backgroundColor:"#2196F3",label:"blue"},{data:l.data[3].map(e=>~~(e/4)),backgroundColor:"	#C0C0C0",label:"multiply"}]})),s=H({responsive:!0});return(i,e)=>(h(),U(o(Xe),{"chart-options":o(s),"chart-data":o(t),"chart-id":m.chartId,"dataset-id-key":m.datasetIdKey,plugins:m.plugins,"css-classes":m.cssClasses,styles:m.styles,width:m.width,height:m.height},null,8,["chart-options","chart-data","chart-id","dataset-id-key","plugins","css-classes","styles","width","height"]))}},ht=C("mdi-content-save"),Pe={setup(m){const{selectedSprite:l}=X();function t(y,...p){let f=new Date().getTime(),x=y(...p),V=new Date().getTime(),k=V-f,T=y.name;return{t1:f,t2:V,dt:k,res:x,name:T}}async function s(y){let{width:p,height:f}=y;const x=document.createElement("canvas");x.width=p,x.height=f;const V=x.getContext("2d");return V.drawImage(y,0,0,p,f),await V.getImageData(0,0,p,f).data}const i=_.map(_.range(256),y=>0),e=$([i,i,i,i]),r=$(!1),u=$(0);let d;const c=$(),g=$();le(async y=>{const p=l.texture.baseTexture.cacheId,f=await engine.loadImg(p),x=await s(f),{width:V,height:k}=f;d=g.value,d.width=V,d.height=k,d.style.width="100%";const T=d.getContext("2d");let S=_.map(_.range(256),N=>0);const w=new GPU,{length:z}=x;let ne=w.createKernel(function(N,W){const A=N[this.thread.x];return this.thread.x%4==3?A:W[A]},{output:[z],graphical:!1});function q(N,W){const A=new Float32Array(N.length);for(let B=0;B<N.length;B+=1){const Q=N[B];B%4==3&&(A[B]=Q),A[B]=W[Q]}return A}function b(){for(let A=0;A<256;A+=1){let B=Z.get(A);S[A]=Math.floor(B)}let N;r.value?N=ne(x,new Float32Array(S)):N=q(x,S);const W=new ImageData(new Uint8ClampedArray(N),V,k);T.putImageData(W,0,0),e.value=engine.pixelsToHistogram(N)}let O;const G=c.value,Z=new Newton([[0,0],[256,256]],G);Z.onUpdate=()=>{O=t(b),u.value=O.dt},O=t(b),u.value=O.dt});function D(){let y=d.toDataURL();const p=PIXI.Texture.from(y);l.texture=p}return(y,p)=>(h(),L(F,null,[n(P,{justify:"center"},{default:a(()=>[I("canvas",{ref_key:"splineRef",ref:c,width:"256",height:"256",style:{width:"100%"}},null,512),I("canvas",{ref_key:"cnvRef",ref:g},null,512)]),_:1}),n(Se,{data:e.value},null,8,["data"]),C(" computed time "+te(u.value)+" ",1),n(P,{justify:"space-around"},{default:a(()=>[n(je,{label:"GPU on",modelValue:r.value,"onUpdate:modelValue":p[0]||(p[0]=f=>r.value=f),color:"green","hide-details":""},null,8,["modelValue"]),n(J,{icon:"",color:"primary",onClick:p[1]||(p[1]=f=>D())},{default:a(()=>[n(ue,null,{default:a(()=>[ht]),_:1})]),_:1})]),_:1})],64))}},gt=C("mdi-content-save"),Ue={setup(m){const{selectedSprite:l}=X();let t;$([0,0,0,0]);let s,i,e;const r=$(),u=$();le(async c=>{const g=l.texture.textureCacheIds[0];s=await engine.loadImg(g);const{width:D,height:y}=s;t=r.value,t.width=D,t.height=y,t.style.width="100%";const p=t.getContext("webgl2",{premultipliedAlpha:!1});i=new GPU({canvas:t,context:p}).createKernel(function(S,w){const z=S[this.thread.y][this.thread.x];this.color(w[Math.floor(z[0]*256)],w[Math.floor(z[1]*256)],w[Math.floor(z[2]*256)],z[3])},{output:[D,y],graphical:!0});let x=_.map(_.range(256),S=>0);function V(){new Date().getTime();for(let S=0;S<256;S+=1){let w=T.get(S);x[S]=w/256}new Date().getTime(),i(s,x),e=i.getPixels()}const k=u.value,T=new Newton([[0,0],[256,256],[128,100]],k);T.onUpdate=V,V()});function d(){const{width:c,height:g}=s,D=document.createElement("canvas");D.width=c,D.height=g;const y=D.getContext("2d"),p=new ImageData(new Uint8ClampedArray(e),c,g);y.putImageData(p,0,0);let f=D.toDataURL();l.texture.baseTexture=new PIXI.BaseTexture(f)}return(c,g)=>(h(),L(F,null,[n(P,{justify:"center"},{default:a(()=>[I("canvas",{ref_key:"splineRef",ref:u,width:"256",height:"256",style:{width:"100%"}},null,512),I("canvas",{ref_key:"cnvRef",ref:r,style:{width:"100%"}},null,512)]),_:1}),n(J,{icon:"",color:"primary",onClick:g[0]||(g[0]=D=>d())},{default:a(()=>[n(ue,null,{default:a(()=>[gt]),_:1})]),_:1})],64))}};const _t=I("br",null,null,-1),xt=I("br",null,null,-1),vt=I("br",null,null,-1),yt=I("br",null,null,-1),$e={setup(m){const l=X(),t=se(l,"selectedSprite"),s=`
      varying vec2 vTextureCoord;
      uniform sampler2D uSampler;
      uniform highp vec4 inputSize;
      uniform vec3 m1;
      uniform vec3 m2;
      uniform vec3 m3;
      uniform float size;
      mat3 mat = mat3(m1,m2,m3);
      void main(void)
      {
        vec2 cord = vTextureCoord;
        vec4 color;
        int i;
        int k;
        for(int i=0;i<3;i+=1){
          vec3 line = mat[i];
          for(int k=0;k<3;k+=1){
            vec2 ncord = vec2(cord.x+inputSize.z*float(i-1)*size,cord.y+inputSize.w*float(k-1)*size);
            color += texture2D(uSampler, ncord) *mat[i][k]  ;
          }
        }
        color.a =1.;
        gl_FragColor = color  ;
      }
      `;let i,e=$();function r(){i=new PIXI.Filter(null,s,{m1:[0,0,0],m2:[0,1,0],m3:[0,0,0],size:1,test:new Float32Array([1,2,3,4,5])}),t.value.filters=[i],e.value=i.uniforms}return r(),de(t,r),(u,d)=>(h(),L("div",null,[R(I("input",{type:"range",min:"0.5",max:"3",step:"0.1","onUpdate:modelValue":d[0]||(d[0]=c=>o(e).size=c)},null,512),[[M,o(e).size]]),_t,R(I("input",{type:"number","onUpdate:modelValue":d[1]||(d[1]=c=>o(e).m1[0]=c)},null,512),[[M,o(e).m1[0]]]),R(I("input",{type:"number","onUpdate:modelValue":d[2]||(d[2]=c=>o(e).m1[1]=c)},null,512),[[M,o(e).m1[1]]]),R(I("input",{type:"number","onUpdate:modelValue":d[3]||(d[3]=c=>o(e).m1[2]=c)},null,512),[[M,o(e).m1[2]]]),xt,R(I("input",{type:"number","onUpdate:modelValue":d[4]||(d[4]=c=>o(e).m2[0]=c)},null,512),[[M,o(e).m2[0]]]),R(I("input",{type:"number","onUpdate:modelValue":d[5]||(d[5]=c=>o(e).m2[1]=c)},null,512),[[M,o(e).m2[1]]]),R(I("input",{type:"number","onUpdate:modelValue":d[6]||(d[6]=c=>o(e).m2[2]=c)},null,512),[[M,o(e).m2[2]]]),vt,R(I("input",{type:"number","onUpdate:modelValue":d[7]||(d[7]=c=>o(e).m3[0]=c)},null,512),[[M,o(e).m3[0]]]),R(I("input",{type:"number","onUpdate:modelValue":d[8]||(d[8]=c=>o(e).m3[1]=c)},null,512),[[M,o(e).m3[1]]]),R(I("input",{type:"number","onUpdate:modelValue":d[9]||(d[9]=c=>o(e).m3[2]=c)},null,512),[[M,o(e).m3[2]]]),yt]))}},De={setup(m){const l=X(),t=se(l,"selectedSprite");let s,i,e,r;const u=$();async function d(x){s=t.value.texture.textureCacheIds[0],i=await engine.loadImg(s),e=await engine.loadPixels(i);const{width:V,height:k}=i;r=u.value,r.width=V,r.height=k,r.style.width="100%",y(0)}de(t,d),le(d);function c(){let x=0;for(let w=0;w<e.length;w+=1)x+=e[w];const V=Number(x)/e.length*3;let k=new Float32Array(e.length),T=0,S=0;for(let w=0;w<e.length;w+=1){const z=e[w];w%4==3&&(k[w]=z),w%4==0&&(T=e[w]+e[w+1]+e[w+2],T<=V?S=0:S=255,k[w]=S,k[w+1]=S,k[w+2]=S)}return k}function g(){let{width:x,height:V}=i,k=new Array(256).fill(0);for(let b=0;b<e.length;b+=1)b%4<3&&(k[e[b]]+=1);k=k.map(b=>b/(3*x*V));const T=k.reduce((b,O,G)=>b+O*G,0);let S=0,w=0;for(let b=0;b<k.length;b++){const O=k.slice(0,b),G=O.reduce((B,Q)=>B+Q,0),Z=1-G,N=O.reduce((B,Q,Le)=>B+Q*Le,0)/G,W=(T-N*G)/Z,A=G*Z*(N-W)**2;A>S&&(S=A,w=b)}let z=new Float32Array(e.length),ne=0,q=0;for(let b=0;b<e.length;b+=1){const O=e[b];b%4==3&&(z[b]=O),b%4==0&&(ne=(e[b]+e[b+1]+e[b+2])/3,ne<=w?q=0:q=255,z[b]=q,z[b+1]=q,z[b+2]=q)}return z}function D(x){if(x==0)return c();if(x==1)return g()}function y(x){const{width:V,height:k}=i,T=r.getContext("2d");let S;S=D(x);const w=new ImageData(new Uint8ClampedArray(S),V,k);T.putImageData(w,0,0)}const p=$(0),f=H([{title:"Gavrilov",value:0},{title:"Otsu",value:1}]);return(x,V)=>(h(),L(F,null,[n(oe,{"onUpdate:modelValue":[y,V[0]||(V[0]=k=>p.value=k)],label:"methods",items:o(f),modelValue:p.value},null,8,["items","modelValue"]),n(P,{justify:"center"},{default:a(()=>[I("canvas",{ref_key:"cnv",ref:u},null,512)]),_:1})],64))}},wt=["src"],bt={setup(m){const l=X(),t=se(l,"selectedSprite"),s=$(0);de(t,()=>{const e=s.value;s.value=0,s.value=e});const i=H([{title:"Params",value:0},{title:"Curves",value:1},{title:"Curves faster",value:2},{title:"Mask filtration",value:3},{title:"Binarization",value:4}]);return(e,r)=>o(t)?(h(),U(me,{key:0},{default:a(()=>[n(ce,null,{default:a(()=>[n(P,{justify:"center"},{default:a(()=>[n(v,{sm:"8"},{default:a(()=>[o(t).texture?(h(),L("img",{key:0,style:{width:"100%"},src:o(t).texture.textureCacheIds[0]},null,8,wt)):K("",!0)]),_:1})]),_:1}),n(oe,{label:"window",items:o(i),modelValue:s.value,"onUpdate:modelValue":r[0]||(r[0]=u=>s.value=u),"hide-details":""},null,8,["items","modelValue"]),n(ke,{style:{margin:"10px 0px"}}),s.value==0?(h(),U(Ce,{key:0})):s.value==1?(h(),U(Pe,{key:1})):s.value==2?(h(),U(Ue,{key:2})):s.value==3?(h(),U($e,{key:3})):s.value==4?(h(),U(De,{key:4})):K("",!0)]),_:1})]),_:1})):K("",!0)}},Vt=I("h2",null,"List of layers",-1),It=["src"],kt=C(" mdi-delete "),Ct=C(" add picture "),be={setup(m){const l=X(),{sprites:t}=l,{drawer:s}=pe(l);function i(u){l.selectedSprite=u,s.value=!1}function e(u){const[d]=t.splice(u,1),{room:c}=engine;c.children=c.children.filter(g=>g.id!=d.id)}function r(u){const d=document.createElement("input");d.type="file",d.multiple=!0,d.accept=".png,.jpg,.jpeg",d.onchange=function(c){console.log(c);const g=c.target.files;for(let D of g){const y=URL.createObjectURL(D),p=engine.addSprite(y);p.on("pointerdown",f=>{i(p)})}},d.click()}return(u,d)=>(h(),L(F,null,[Vt,(h(!0),L(F,null,re(o(t),(c,g)=>(h(),U(me,{key:g,onClick:D=>i(c)},{default:a(()=>[n(ce,null,{default:a(()=>[n(P,{align:"center"},{default:a(()=>[c.texture?(h(),L(F,{key:0},[n(v,{cols:"2",sm:"3"},{default:a(()=>[I("img",{src:c.texture.textureCacheIds[0],style:{width:"100%"}},null,8,It)]),_:2},1024),n(v,{cols:"8",sm:"6"},{default:a(()=>[C(te(c.Name),1)]),_:2},1024),n(v,{cols:"2",sm:"3"},{default:a(()=>[I("div",null,[n(J,{icon:"",onClick:D=>e(g),color:"red"},{default:a(()=>[n(ue,null,{default:a(()=>[kt]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024)],64)):(h(),U(v,{key:1},{default:a(()=>[C(te(c.Name),1)]),_:2},1024))]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),n(J,{color:"green",onClick:r},{default:a(()=>[Ct]),_:1})],64))}},St=C(" alpha "),Pt=C(" width "),Ut=C(" height "),$t={props:["selectedSprite"],setup(m){const{room:l}=engine,t=ae({get:()=>l.alpha,set:e=>l.alpha=e}),s=ae({get:()=>l.width,set:e=>l.width=e}),i=ae({get:()=>l.height,set:e=>l.height=e});return(e,r)=>(h(),L(F,null,[n(Ie,{label:"name",modelValue:m.selectedSprite.Name,"onUpdate:modelValue":r[0]||(r[0]=u=>m.selectedSprite.Name=u),"hide-details":""},null,8,["modelValue"]),n(P,null,{default:a(()=>[n(v,{xs:"1",sm:"3"},{default:a(()=>[St]),_:1}),n(v,null,{default:a(()=>[R(I("input",{type:"range",max:"1",min:"0",step:"0.05",color:"blue","onUpdate:modelValue":r[1]||(r[1]=u=>ie(t)?t.value=u:null)},null,512),[[M,o(t)]])]),_:1})]),_:1}),n(P,null,{default:a(()=>[n(v,{sm:"3"},{default:a(()=>[Pt]),_:1}),n(v,null,{default:a(()=>[R(I("input",{type:"range",min:"0",max:"1080",step:"5",color:"blue","onUpdate:modelValue":r[2]||(r[2]=u=>ie(s)?s.value=u:null)},null,512),[[M,o(s)]])]),_:1})]),_:1}),n(P,null,{default:a(()=>[n(v,{sm:"3"},{default:a(()=>[Ut]),_:1}),n(v,null,{default:a(()=>[R(I("input",{type:"range",min:"0",max:"1080",step:"5",color:"blue","thumb-label":"","onUpdate:modelValue":r[3]||(r[3]=u=>ie(i)?i.value=u:null)},null,512),[[M,o(i)]])]),_:1})]),_:1})],64))}},Dt=C("update histogram"),Lt={props:["selectedSprite"],setup(m){const l=_.map(_.range(256),i=>0),t=$([l,l,l,l]);function s(){t.value=H(engine.histogram())}return(i,e)=>(h(),L(F,null,[n(Se,{data:t.value},null,8,["data"]),n(J,{color:"green",onClick:s},{default:a(()=>[Dt]),_:1})],64))}},Et={setup(m){const l=X(),t=toRef(l,"selectedSprite"),s=$(0),i=H([{title:"params",value:0},{title:"gradient transformations",value:1}]);return(e,r)=>o(t)?(h(),U(me,{key:0},{default:a(()=>[n(ce,null,{default:a(()=>[n(oe,{label:"window",items:o(i),modelValue:s.value,"onUpdate:modelValue":r[0]||(r[0]=u=>s.value=u),"hide-details":""},null,8,["items","modelValue"]),n(ke,{style:{margin:"10px 0px"}}),s.value==0?(h(),U($t,{key:0,selectedSprite:o(t)},null,8,["selectedSprite"])):s.value==1?(h(),U(Lt,{key:1,selectedSprite:o(t)},null,8,["selectedSprite"])):K("",!0)]),_:1})]),_:1})):K("",!0)}};const zt=C(" options "),Nt=C(" windows "),At={setup(m){const l=X(),{selectedSprite:t,drawer:s,isEditor:i,isList:e}=pe(l),r=[$(),$(),$(),$(),$()];le(()=>{r.map(y=>{var p,f;return(f=(p=y.value)==null?void 0:p.winbox)==null?void 0:f.close()})});const u=()=>s.value=!!(1-s.value),d=y=>{var f,x,V;const p=(f=r[y])==null?void 0:f.value;if(!!p){if(y==0){p.initialized||p.initialize();return}if(((x=t.value)==null?void 0:x.type)=="sprite")return p.initialized&&((V=p.winbox)==null||V.close()),p.initialize()}},c=H([{title:"download",func:()=>engine.downImg()},{title:"editor toggle",func:()=>i.value=!i.value},{title:"sprite list toggle",func:()=>e.value=!e.value}]),g=y=>y.func&&y.func(),D=H(["params","curves","curves fast","mask filtration","binarization"]);return(y,p)=>(h(),L(F,null,[n(He,{"extension-height":"40"},{prepend:a(()=>[n(Ge,{onClick:u})]),append:a(()=>[]),default:a(()=>[n(Ke,null,{default:a(()=>[n(_e,null,{activator:a(({props:f})=>[n(J,xe({color:"primary"},f),{default:a(()=>[zt]),_:2},1040)]),default:a(()=>[n(ve,null,{default:a(()=>[(h(!0),L(F,null,re(o(c),(f,x)=>(h(),U(we,{key:x,value:f,onClick:V=>g(f)},{default:a(()=>[n(ye,null,{default:a(()=>[C(te(f.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1}),n(_e,null,{activator:a(({props:f})=>[n(J,xe({color:"primary"},f),{default:a(()=>[Nt]),_:2},1040)]),default:a(()=>[n(ve,null,{default:a(()=>[(h(!0),L(F,null,re(o(D),(f,x)=>(h(),U(we,{key:x,value:f,onClick:V=>d(x)},{default:a(()=>[n(ye,null,{default:a(()=>[C(te(f),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),n(o(ee),{options:{title:"params",class:"modern",height:"500px",width:"300px"},ref:r[0]},{default:a(()=>[n(Ce)]),_:1},512),n(o(ee),{options:{title:"curves",class:"modern",height:"600px",width:"300px"},ref:r[1]},{default:a(()=>[n(Pe)]),_:1},512),n(o(ee),{options:{title:"curves fast",class:"modern",height:"600px",width:"300px"},ref:r[2]},{default:a(()=>[n(Ue)]),_:1},512),n(o(ee),{options:{title:"masks filtration",class:"modern",height:"300px",width:"300px"},ref:r[3]},{default:a(()=>[n($e)]),_:1},512),n(o(ee),{options:{title:"binarization",class:"modern",height:"500px",width:"300px"},ref:r[4]},{default:a(()=>[n(De)]),_:1},512)],64))}};const Tt=I("div",{id:"window"},null,-1),Rt={setup(m){const l=X(),{sprites:t}=l,{selectedSprite:s,drawer:i,isEditor:e,isList:r}=pe(l);return le(()=>{engine=new tt(document.getElementById("window"),t),vm=this}),(u,d)=>(h(),U(qe,null,{default:a(()=>[n(At),n(We,{modelValue:o(i),"onUpdate:modelValue":d[0]||(d[0]=c=>ie(i)?i.value=c:null),absolute:"",bottom:"",temporary:""},{default:a(()=>[n(be)]),_:1},8,["modelValue"]),n(Ye,null,{default:a(()=>[n(P,null,{default:a(()=>[n(v,{sm:o(e)||o(r)?8:12,cols:"12"},{default:a(()=>[Tt]),_:1},8,["sm"]),o(e)||o(r)?(h(),U(v,{key:0,sm:"4",style:{height:"96vh","overflow-y":"auto"}},{default:a(()=>{var c;return[o(e)?(h(),L(F,{key:0},[((c=o(s))==null?void 0:c.type)=="layer"?(h(),U(Et,{key:0})):(h(),U(bt,{key:1}))],64)):K("",!0),o(r)?(h(),U(be,{key:1})):K("",!0)]}),_:1})):K("",!0)]),_:1})]),_:1})]),_:1}))}};var Mt=Je();const Bt="modulepreload",Ve={},Ft="./",Ot=function(l,t){return!t||t.length===0?l():Promise.all(t.map(s=>{if(s=`${Ft}${s}`,s in Ve)return;Ve[s]=!0;const i=s.endsWith(".css"),e=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${e}`))return;const r=document.createElement("link");if(r.rel=i?"stylesheet":Bt,i||(r.as="script",r.crossOrigin=""),r.href=s,document.head.appendChild(r),i)return new Promise((u,d)=>{r.addEventListener("load",u),r.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>l())};async function Xt(){(await Ot(()=>import("./webfontloader.cd097671.js").then(function(l){return l.w}),[])).load({google:{families:["Roboto:100,300,400,500,700,900&display=swap"]}})}Xt();Qe(Rt).use(Mt,{},!1,"bootstrap3").use(Ze()).mount("#app");
