var X=Object.defineProperty;var j=(s,l,r)=>l in s?X(s,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[l]=r;var f=(s,l,r)=>(j(s,typeof l!="symbol"?l+"":l,r),r);import{r as L,o as c,c as b,a as e,V as T,u as x,b as R,w as i,d,e as S,f as p,F as v,g as m,h as A,i as g,j as C,k as K,l as O,m as B,n as H,p as U,q as V,s as q,t as P,v as z,x as k,y as N,z as $,A as D,B as W,C as Y,D as G,E as J,G as Q,H as Z,I as ee,J as te,K as le,L as se,M as ie,N as ae,O as ne,P as re,Q as oe,R as de,S as ue,T as w,U as ce,W as me,X as fe,Y as pe}from"./vendor.254d6a6a.js";const he=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(t){if(t.ep)return;t.ep=!0;const n=r(t);fetch(t.href,n)}};he();class ge extends PIXI.Container{constructor(){super(...arguments);f(this,"Name","layer");f(this,"type","layer")}get r(){return(this.tint&16711680)/65536,(this.tint&16711680)/65536}set r(l){let r=l%256*65536+(65535&this.tint);this.tint=r}get g(){return(this.tint&65280)/256}set g(l){this.tint=l%256*256+(16711935&this.tint)}get b(){return this.tint&255}set b(l){this.tint=l%256+(16776960&this.tint)}}class _e extends PIXI.Sprite{constructor(){super(...arguments);f(this,"Name","picture");f(this,"type","sprite")}get r(){return(this.tint&16711680)/65536,(this.tint&16711680)/65536}set r(l){let r=l%256*65536+(65535&this.tint);this.tint=r}get g(){return(this.tint&65280)/256}set g(l){this.tint=l%256*256+(16711935&this.tint)}get b(){return this.tint&255}set b(l){this.tint=l%256+(16776960&this.tint)}}class xe{constructor(l,r){f(this,"sprites",[]);f(this,"textures",[]);f(this,"width",1080);f(this,"height",768);f(this,"ctx");f(this,"view");f(this,"app");f(this,"room");f(this,"extract");f(this,"_sprites",0);this.sprites=r;const a=new PIXI.Application({width:this.width,height:this.height,transparent:!0,resolution:window.devicePixelRatio||1});this.extract=a.renderer.extract,this.app=a,this.view=a.view;const{stage:t}=a;this.stage=t;const n=new ge;n.Name="Main layer",n.id=0,t.addChild(n),this.room=n,r.push({Name:"Main layer",type:"layer",id:0}),this.ctx=this.view.getContext("webgl2"),l.appendChild(a.view)}pixels(){return this.extract.pixels(this.app.stage)}pixelsToHistogram(l){const r=_.map(_.range(256),n=>0);let a=[r.slice(),r.slice(),r.slice(),r.slice()],t;for(let n=0;n<l.length;n+=1)n%4!=3&&~~(n/4)*4+3!=0&&(t=l[n],a[n%4][t]+=1,a[3][t]+=1);return a}histogram(){const l=this.pixels();return this.pixelsToHistogram(l)}saveFile(l,r="outImg"){let a=document.createElement("a");a.setAttribute("href",l),a.setAttribute("download",r),a.click()}downImg(){const l=this.extract.image(this.app.stage);this.saveFile(l.src)}addSprite(l){const{textures:r,sprites:a,room:t}=this,n=PIXI.Texture.from(l);r.push(n),this._sprites+=1;const o=new _e(n);o.id=this._sprites,a.push(o),t.addChild(o)}}const Se=m(" width "),ye=m(" height "),be=m(" red "),Ve=m(" green "),we=m(" blue "),ve=m(" alpha "),Ie=m(" x "),Ce=m(" y "),ke={props:["selectedSprite"],setup(s){const l=L([{title:"normal",value:PIXI.BLEND_MODES.NORMAL},{title:"add",value:PIXI.BLEND_MODES.ADD},{title:"multiply",value:PIXI.BLEND_MODES.MULTIPLY},{title:"average",value:PIXI.BLEND_MODES.SCREEN}]);return(r,a)=>(c(),b(v,null,[e(T,{label:"name",modelValue:s.selectedSprite.Name,"onUpdate:modelValue":a[0]||(a[0]=t=>s.selectedSprite.Name=t),"hide-details":""},null,8,["modelValue"]),e(R,{label:"blend mode",items:x(l),modelValue:s.selectedSprite.blendMode,"onUpdate:modelValue":a[1]||(a[1]=t=>s.selectedSprite.blendMode=t),"hide-details":""},null,8,["items","modelValue"]),e(p,null,{default:i(()=>[e(d,{sm:"3"},{default:i(()=>[Se]),_:1}),e(d,null,{default:i(()=>[e(S,{min:"0",max:"1080",step:"5","thumb-label":"","hide-details":"auto",color:"blue",modelValue:s.selectedSprite.width,"onUpdate:modelValue":a[2]||(a[2]=t=>s.selectedSprite.width=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:i(()=>[e(d,{sm:"3"},{default:i(()=>[ye]),_:1}),e(d,null,{default:i(()=>[e(S,{min:"0",max:"1080",step:"5","thumb-label":"",color:"blue","hide-details":"auto",modelValue:s.selectedSprite.height,"onUpdate:modelValue":a[3]||(a[3]=t=>s.selectedSprite.height=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:i(()=>[e(d,{sm:"3"},{default:i(()=>[be]),_:1}),e(d,null,{default:i(()=>[e(S,{min:"0",max:"255",step:"5","thumb-label":"",color:"red","hide-details":"auto",modelValue:s.selectedSprite.r,"onUpdate:modelValue":a[4]||(a[4]=t=>s.selectedSprite.r=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:i(()=>[e(d,{sm:"3"},{default:i(()=>[Ve]),_:1}),e(d,null,{default:i(()=>[e(S,{min:"0",max:"255",step:"5","thumb-label":"",color:"green","hide-details":"auto",modelValue:s.selectedSprite.g,"onUpdate:modelValue":a[5]||(a[5]=t=>s.selectedSprite.g=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:i(()=>[e(d,{sm:"3"},{default:i(()=>[we]),_:1}),e(d,null,{default:i(()=>[e(S,{min:"0",max:"255",step:"5","thumb-label":"",color:"blue","hide-details":"auto",modelValue:s.selectedSprite.b,"onUpdate:modelValue":a[6]||(a[6]=t=>s.selectedSprite.b=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:i(()=>[e(d,{xs:"1",sm:"3"},{default:i(()=>[ve]),_:1}),e(d,null,{default:i(()=>[e(S,{"hide-details":"auto",max:"1",min:"0",step:"0.05",color:"blue","thumb-label":"",modelValue:s.selectedSprite.alpha,"onUpdate:modelValue":a[7]||(a[7]=t=>s.selectedSprite.alpha=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:i(()=>[e(d,{sm:"3"},{default:i(()=>[Ie]),_:1}),e(d,null,{default:i(()=>[e(S,{min:"0",max:"1080",step:"5","thumb-label":"",color:"blue","hide-details":"auto",modelValue:s.selectedSprite.x,"onUpdate:modelValue":a[8]||(a[8]=t=>s.selectedSprite.x=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:i(()=>[e(d,{sm:"3"},{default:i(()=>[Ce]),_:1}),e(d,null,{default:i(()=>[e(S,{min:"0",max:"1080",step:"5","thumb-label":"",color:"blue","hide-details":"auto",modelValue:s.selectedSprite.y,"onUpdate:modelValue":a[9]||(a[9]=t=>s.selectedSprite.y=t)},null,8,["modelValue"])]),_:1})]),_:1})],64))}},Le={},Ee=["src"],Ne={props:["selectedSprite"],setup(s){const l=A(0),r=L([{title:"params",value:0}]);return(a,t)=>s.selectedSprite?(c(),g(B,{key:0},{default:i(()=>[e(O,null,{default:i(()=>[e(p,{justify:"center"},{default:i(()=>[e(d,{sm:"8"},{default:i(()=>[s.selectedSprite.texture?(c(),b("img",{key:0,style:{width:"100%"},src:s.selectedSprite.texture.textureCacheIds[0]},null,8,Ee)):C("",!0)]),_:1})]),_:1}),e(R,{label:"window",items:x(r),modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=n=>l.value=n),"hide-details":""},null,8,["items","modelValue"]),e(K,{style:{margin:"10px 0px"}}),l.value==0?(c(),g(ke,{key:0,selectedSprite:s.selectedSprite},null,8,["selectedSprite"])):l.value==1?(c(),g(Le,{key:1,selectedSprite:s.selectedSprite},null,8,["selectedSprite"])):C("",!0)]),_:1})]),_:1})):C("",!0)}},$e=V("h2",null,"List of layers",-1),De=m(" mdi-delete "),Ue=m(" add picture "),Pe={props:["sprites","selectedSprite"],emits:["selectSprite"],setup(s){const{sprites:l,selectedSprite:r}=s;A(r);function a(n){const[o]=l.splice(n,1),{room:u}=engine;u.children=u.children.filter(h=>h.id!=o.id)}function t(n){const o=document.createElement("input");o.type="file",o.multiple=!0,o.accept=".png,.jpg,.jpeg",o.onchange=function(u){console.log(u);const h=u.target.files;for(let y of h){const E=URL.createObjectURL(y);engine.addSprite(E)}},o.click()}return(n,o)=>(c(),b(v,null,[$e,(c(!0),b(v,null,H(s.sprites,(u,h)=>(c(),g(B,{key:h,onClick:y=>n.$emit("selectSprite",u)},{default:i(()=>[e(O,null,{default:i(()=>[e(p,{align:"center"},{default:i(()=>[u.texture?(c(),b(v,{key:0},[e(d,{cols:"2",sm:"3"},{default:i(()=>[e(q,{src:u.texture.textureCacheIds[0]},null,8,["src"])]),_:2},1024),e(d,{cols:"8",sm:"6"},{default:i(()=>[m(P(u.Name),1)]),_:2},1024),e(d,{cols:"2",sm:"3"},{default:i(()=>[V("div",null,[e(U,{icon:"",onClick:y=>a(h),color:"red"},{default:i(()=>[e(z,null,{default:i(()=>[De]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024)],64)):(c(),g(d,{key:1},{default:i(()=>[m(P(u.Name),1)]),_:2},1024))]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),e(U,{color:"green",onClick:t},{default:i(()=>[Ue]),_:1})],64))}},Ae=m(" alpha "),Oe=m(" width "),Be=m(" height "),Me={props:["selectedSprite"],setup(s){const{room:l}=engine;A(l);const r=k({get:()=>l.alpha,set:n=>l.alpha=n}),a=k({get:()=>l.width,set:n=>l.width=n}),t=k({get:()=>l.height,set:n=>l.height=n});return(n,o)=>s.selectedSprite?(c(),g(B,{key:0},{default:i(()=>[e(O,null,{default:i(()=>[e(T,{label:"name",modelValue:s.selectedSprite.Name,"onUpdate:modelValue":o[0]||(o[0]=u=>s.selectedSprite.Name=u),"hide-details":""},null,8,["modelValue"]),e(p,null,{default:i(()=>[e(d,{xs:"1",sm:"3"},{default:i(()=>[Ae]),_:1}),e(d,null,{default:i(()=>[N(V("input",{type:"range",max:"1",min:"0",step:"0.05",color:"blue","onUpdate:modelValue":o[1]||(o[1]=u=>D(r)?r.value=u:null)},null,512),[[$,x(r)]])]),_:1})]),_:1}),e(p,null,{default:i(()=>[e(d,{sm:"3"},{default:i(()=>[Oe]),_:1}),e(d,null,{default:i(()=>[N(V("input",{type:"range",min:"0",max:"1080",step:"5",color:"blue","onUpdate:modelValue":o[2]||(o[2]=u=>D(a)?a.value=u:null)},null,512),[[$,x(a)]])]),_:1})]),_:1}),e(p,null,{default:i(()=>[e(d,{sm:"3"},{default:i(()=>[Be]),_:1}),e(d,null,{default:i(()=>[N(V("input",{type:"range",min:"0",max:"1080",step:"5",color:"blue","thumb-label":"","onUpdate:modelValue":o[3]||(o[3]=u=>D(t)?t.value=u:null)},null,512),[[$,x(t)]])]),_:1})]),_:1})]),_:1})]),_:1})):C("",!0)}},Fe=m(" options "),Te={emits:["drawHistogram"],setup(s,{emit:l}){function r(){engine.downImg()}const a=L([{title:"download",func:r},{title:"draw histogram",func:()=>l("drawHistogram")}]);function t(n){n.func&&n.func()}return(n,o)=>(c(),g(Z,{"extension-height":"40"},{prepend:i(()=>[e(W)]),append:i(()=>[]),default:i(()=>[e(Q,null,{default:i(()=>[e(Y,null,{activator:i(({props:u})=>[e(U,G({color:"primary"},u),{default:i(()=>[Fe]),_:2},1040)]),default:i(()=>[e(J,null,{default:i(()=>[(c(!0),b(v,null,H(x(a),(u,h)=>(c(),g(ee,{key:h,value:u},{default:i(()=>[e(te,{onClick:y=>t(u)},{default:i(()=>[m(P(u.title),1)]),_:2},1032,["onClick"])]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}},Re={props:{chartId:{type:String,default:"bar-chart"},datasetIdKey:{type:String,default:"label"},width:{type:Number,default:400},height:{type:Number,default:400},cssClasses:{default:"",type:String},styles:{type:Object,default:()=>{}},plugins:{type:Array,default:()=>[]},data:{type:Array,default:()=>[_.map(_.range(256),s=>0),_.map(_.range(256),s=>0),_.map(_.range(256),s=>0),_.map(_.range(256),s=>0)]}},setup(s){const l=s;le.register(se,ie,ae,ne,re,oe,de);const r=k(t=>({labels:_.range(256),datasets:[{data:l.data[0],borderColor:"#F44336",label:"red"},{data:l.data[1],borderColor:"#4CAF50",label:"green"},{data:l.data[2],borderColor:"#2196F3",label:"blue"},{data:l.data[3].map(n=>~~(n/4)),borderColor:"#3F51B5",label:"rgb"}]})),a=L({responsive:!0});return(t,n)=>(c(),g(x(ue),{"chart-options":x(a),"chart-data":x(r),"chart-id":s.chartId,"dataset-id-key":s.datasetIdKey,plugins:s.plugins,"css-classes":s.cssClasses,styles:s.styles,width:s.width,height:s.height},null,8,["chart-options","chart-data","chart-id","dataset-id-key","plugins","css-classes","styles","width","height"]))}};var He=(s,l)=>{const r=s.__vccOpts||s;for(const[a,t]of l)r[a]=t;return r};const I=_.map(_.range(256),s=>0),Xe={components:{spriteList:Pe,spriteEdit:Ne,LayerEdit:Me,bar:Te,Histogram:Re},data(){return{imgs:[],selectedSprite:void 0,histogramData:[I,I,I,I]}},methods:{selectSprite(s){this.selectedSprite=s},drawHistogram(){this.histogramData=engine.histogram()}},mounted(){engine=new xe(document.getElementById("window"),this.imgs),this.engine=engine,vm=this}},je=V("div",{id:"window"},null,-1);function Ke(s,l,r,a,t,n){const o=w("bar"),u=w("histogram"),h=w("layer-edit"),y=w("sprite-edit"),E=w("sprite-list");return c(),g(ce,null,{default:i(()=>[e(o,{onDrawHistogram:n.drawHistogram},null,8,["onDrawHistogram"]),e(me,null,{default:i(()=>[e(p,null,{default:i(()=>[e(d,{sm:"8"},{default:i(()=>[je,e(d,{md:"8"},{default:i(()=>[e(u,{data:t.histogramData},null,8,["data"])]),_:1})]),_:1}),e(d,{sm:"4"},{default:i(()=>{var M;return[((M=t.selectedSprite)==null?void 0:M.type)=="layer"?(c(),g(h,{key:0,selectedSprite:t.selectedSprite},null,8,["selectedSprite"])):(c(),g(y,{key:1,selectedSprite:t.selectedSprite},null,8,["selectedSprite"])),e(E,{sprites:t.imgs,onSelectSprite:n.selectSprite,selectedSprite:t.selectedSprite},null,8,["sprites","onSelectSprite","selectedSprite"])]}),_:1})]),_:1})]),_:1})]),_:1})}var qe=He(Xe,[["render",Ke]]);var ze=fe();const We="modulepreload",F={},Ye="./",Ge=function(l,r){return!r||r.length===0?l():Promise.all(r.map(a=>{if(a=`${Ye}${a}`,a in F)return;F[a]=!0;const t=a.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${n}`))return;const o=document.createElement("link");if(o.rel=t?"stylesheet":We,t||(o.as="script",o.crossOrigin=""),o.href=a,document.head.appendChild(o),t)return new Promise((u,h)=>{o.addEventListener("load",u),o.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>l())};async function Je(){(await Ge(()=>import("./webfontloader.cd097671.js").then(function(l){return l.w}),[])).load({google:{families:["Roboto:100,300,400,500,700,900&display=swap"]}})}Je();pe(qe).use(ze,{},!1,"bootstrap3").mount("#app");
